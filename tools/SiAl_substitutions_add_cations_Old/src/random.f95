SUBROUTINE GET_SEED(SEED)
 IMPLICIT NONE
 INTEGER DAY,HOUR,I4_HUGE,SEED
 PARAMETER (I4_HUGE=2147483647)
 INTEGER MILLI,MINUTE,MONTH,SECOND,YEAR
 DOUBLE PRECISION :: TEMP
 CHARACTER*(10) :: TIME
 CHARACTER*(8)  :: DATE
 CALL DATE_AND_TIME (DATE,TIME)
 READ(DATE,'(i4,i2,i2)')YEAR,MONTH,DAY
 READ(TIME,'(i2,i2,i2,1x,i3)')HOUR,MINUTE,SECOND,MILLI
 TEMP=0.0D+00
 TEMP=TEMP+DBLE(MONTH-1)/11.0D+00
 TEMP=TEMP+DBLE(DAY-1)/30.0D+00
 TEMP=TEMP+DBLE(HOUR)/23.0D+00
 TEMP=TEMP+DBLE(MINUTE)/59.0D+00
 TEMP=TEMP+DBLE(SECOND)/59.0D+00
 TEMP=TEMP+DBLE(MILLI)/999.0D+00
 TEMP=TEMP/6.0D+00
 DO WHILE(TEMP<=0.0D+00)
   TEMP=TEMP+1.0D+00
 ENDDO
 DO WHILE (1.0D+00<TEMP)
   TEMP=TEMP-1.0D+00
 ENDDO
 SEED=INT(DBLE(I4_HUGE)*TEMP)
 IF(SEED == 0) SEED=1
 IF(SEED == I4_HUGE) SEED=SEED-1
 RETURN
END SUBROUTINE
!
REAL FUNCTION R4_UNIFORM(B1,B2,SEED)
 IMPLICIT NONE
 REAL :: B1,B2
 INTEGER, PARAMETER :: I4_HUGE=2147483647
 INTEGER :: K,SEED
 K = SEED/127773
 SEED = 16807*(SEED-K*17773) - K*2836
 if(SEED < 0) SEED = SEED + I4_HUGE
 R4_UNIFORM = B1 + (B2 - B1)*REAL(DBLE(SEED)*4.656612875D-10)
 RETURN
END FUNCTION R4_UNIFORM

REAL FUNCTION GRANDOM(iseed,stdev)
 IMPLICIT NONE
 INTEGER :: ISEED
 REAL, PARAMETER :: PI = ACOS(0.0)
 REAL :: STDEV,FCT,R1,R2,R4_UNIFORM,TWOPI
 REAL, SAVE :: RN1,RN2
 LOGICAL, SAVE :: LSECOND=.FALSE.
 twopi = 2.0*PI
 IF(lsecond)THEN
    grandom = rn2
    lsecond = .false.
 ELSE
    r1 = R4_UNIFORM(0.0,1.0,ISEED)
    r2 = R4_UNIFORM(0.0,1.0,ISEED)
    r2 = r2*twopi
    fct = sqrt( - 2.0*log(r1))
    rn1 = fct*cos(r2)
    rn2 = fct*sin(r2)
    GRANDOM = rn1
    lsecond = .true.
  endif
return
END FUNCTION GRANDOM
